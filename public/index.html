<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Devil Fruit Ability Builder</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="app-root">
      <header class="app-header">
        <div class="header-fruit-row">
          <img src="img/op-fruit.png" alt="Devil Fruit" class="header-fruit" />
          <div class="header-text">
            <h1>Devil Fruit Ability Builder</h1>
            <p>
              Build custom, cinematic devil-fruit abilities on the fly for your One
              Piece‚Äìstyle DnD game.
            </p>
          </div>
          <img src="img/op-fruit.png" alt="Devil Fruit" class="header-fruit" />
        </div>
      </header>

      <main class="app-main">
        <!-- LEFT: Inputs -->
        <section class="panel panel-inputs">
          <!-- Character Context -->
          <div class="card">
            <h2>Character Context</h2>
            <div class="field-grid">
              <label>
                Name
                <input id="char-name" type="text" placeholder="Elren, Panther, etc." />
              </label>
              <label>
                Combat Role
                <input
                  id="char-role"
                  type="text"
                  placeholder="Frontline bruiser, sniper, support, etc."
                />
              </label>
            </div>
            <label>
              Theme / Vibe
              <input
                id="char-theme"
                type="text"
                placeholder="Red lightning, gravity-bending, soul flames, etc."
              />
            </label>
            <label>
              Backstory / Notes
              <textarea
                id="char-backstory"
                rows="3"
                placeholder="Quick backstory, goals, personality, emotional beats..."
              ></textarea>
            </label>
          </div>

          <!-- Effect Types -->
          <div class="card">
            <h2>A. Effect Types ‚öîÔ∏è</h2>
            <div class="checkbox-grid">
              <label>
                <input type="checkbox" name="effectTypes" value="Offense" />
                Offense (damage, burst, big hits)
              </label>
              <label>
                <input type="checkbox" name="effectTypes" value="Defense" />
                Defense (barriers, armor, damage reduction)
              </label>
              <label>
                <input type="checkbox" name="effectTypes" value="Support" />
                Support (buffs, healing, team utility)
              </label>
              <label>
                <input type="checkbox" name="effectTypes" value="Control" />
                Control (crowd control, traps, positioning)
              </label>
              <label>
                <input type="checkbox" name="effectTypes" value="Utility" />
                Utility (movement, scouting, information)
              </label>
              <label>
                <input type="checkbox" name="effectTypes" value="Reality-Bending" />
                Reality-Bending (space, time, gravity, souls)
              </label>
            </div>
            <label>
              Extra Effect Notes
              <textarea
                id="effect-notes"
                rows="2"
                placeholder="e.g. one big finisher, one defensive reaction, one team buff‚Ä¶"
              ></textarea>
            </label>
          </div>

          <!-- Devil Fruit Types (box B, with fruit icon) -->
          <div class="card">
            <h2 class="fruit-heading">
              <span>B. Devil Fruit Types üçá</span>
              <img
                src="img/op-fruit.png"
                alt="Devil Fruit"
                class="inline-fruit-icon"
              />
            </h2>
            <p class="hint">
              Select the <strong>categories</strong> of devil fruits involved in this combo
              (not specific powers like gravity or ice).
            </p>
            <div class="checkbox-grid">
              <label>
                <input type="checkbox" name="fruitTraits" value="Logia" />
                Logia (elemental body)
              </label>
              <label>
                <input type="checkbox" name="fruitTraits" value="Paramecia" />
                Paramecia (reality-warping, objects, special rules)
              </label>
              <label>
                <input type="checkbox" name="fruitTraits" value="Zoan" />
                Zoan (animal / hybrid transformation)
              </label>
              <label>
                <input type="checkbox" name="fruitTraits" value="Mythical Zoan" />
                Mythical Zoan (mythic beast / deity)
              </label>
              <label>
                <input type="checkbox" name="fruitTraits" value="Ancient Zoan" />
                Ancient Zoan (prehistoric creatures)
              </label>
              <label>
                <input type="checkbox" name="fruitTraits" value="Special" />
                Special / Unique (weird, hard-to-classify fruits)
              </label>
              <label>
                <input type="checkbox" name="fruitTraits" value="Artificial" />
                Artificial / SMILE-style fruits
              </label>
              <label>
                <input type="checkbox" name="fruitTraits" value="Awakened" />
                Awakened fruit (environment + body changes)
              </label>
              <label>
                <input type="checkbox" name="fruitTraits" value="Hybrid Combo" />
                Hybrid multi-fruit synergy (multiple powers combined)
              </label>
            </div>
            <label>
              Extra Fruit Notes
              <textarea
                id="fruit-notes"
                rows="2"
                placeholder="Specific fruits or combos, e.g. Kaido‚Äôs dragon + hormone-style body control + ice-themed flavor."
              ></textarea>
            </label>
          </div>

          <!-- Outcome / Shape (Box C reworked) -->
          <div class="card">
            <h2>C. Desired Outcome / Ability Shape üí•</h2>
            <p class="hint">
              What do you want the combo to <strong>actually do</strong> in the scene? Pick
              a few, then use the notes box to specify an exact outcome.
            </p>
            <div class="checkbox-grid">
              <label>
                <input type="checkbox" name="styleMods" value="Barrier" />
                Barrier / Shield (block or reduce damage)
              </label>
              <label>
                <input type="checkbox" name="styleMods" value="Restrain" />
                Restrain / Bind (immobilize, grapple, root, imprison)
              </label>
              <label>
                <input type="checkbox" name="styleMods" value="Zone" />
                Area Denial / Zone (hazardous terrain, control area)
              </label>
              <label>
                <input type="checkbox" name="styleMods" value="Morphing" />
                Morphing / Weapon Form (change shape, weaponization)
              </label>
              <label>
                <input type="checkbox" name="styleMods" value="Overcharge" />
                Overcharge / Self-Buff (power spike at a cost)
              </label>
              <label>
                <input type="checkbox" name="styleMods" value="Mobility" />
                Mobility / Gap Closer / Escape
              </label>
              <label>
                <input type="checkbox" name="styleMods" value="Debuff" />
                Debuff / Weakening (reduce stats, impose conditions)
              </label>
              <label>
                <input type="checkbox" name="styleMods" value="Explosion" />
                Explosion / Burst (big AoE damage)
              </label>
              <label>
                <input type="checkbox" name="styleMods" value="Battlefield Control" />
                Battlefield Control (push/pull, reposition, knockback)
              </label>
              <label>
                <input type="checkbox" name="styleMods" value="Signature Finisher" />
                Signature Finisher (big named move, ultimate)
              </label>
            </div>
            <label>
              Outcome / Effect Notes
              <textarea
                id="style-notes"
                rows="2"
                placeholder="Describe the exact outcome you want: e.g. 'A red-lightning dome that blocks a blast and then explodes outward.'"
              ></textarea>
            </label>
          </div>

          <!-- Output Preferences (Box D improved) -->
          <div class="card">
            <h2>D. Output Preferences üìú</h2>
            <div class="field-grid">
              <label>
                # of abilities
                <input id="num-abilities" type="number" min="1" max="6" value="3" />
              </label>
              <label>
                Output style
                <select id="format-style">
                  <option value="stat-block">
                    DnD-style stat block / spell card (compact but structured)
                  </option>
                  <option value="minimal">
                    Very minimal quick reference (shorter text, to the point)
                  </option>
                  <option value="cinematic">
                    Longer, more descriptive & cinematic (extra flavor)
                  </option>
                </select>
              </label>
            </div>

            <!-- Model choice -->
            <label>
              Model / AI power level
              <select id="model-choice">
                <option value="gpt-4.1-mini">
                  Fast & cheap (gpt-4.1-mini) ‚Äì recommended for most use
                </option>
                <option value="gpt-4.1">
                  Stronger (gpt-4.1) ‚Äì better quality, higher cost
                </option>
                <option value="gpt-5.1">
                  Max power (gpt-5.1) ‚Äì requires verified org; may error if not allowed
                </option>
              </select>
            </label>

            <label>
              Mechanics detail level
              <select id="mechanics-detail">
                <option value="simple">
                  Simple: action type, range, save, damage, and 1‚Äì2 core effects
                </option>
                <option value="detailed">
                  Detailed: include conditions, scaling notes, and special rules
                </option>
              </select>
            </label>

            <!-- Preferred DC -->
            <label>
              Preferred DC (optional, guideline)
              <input
                id="preferred-dc"
                type="text"
                placeholder="e.g. 18 or 8 + proficiency + CHA"
              />
            </label>

            <!-- Power level number -->
            <label>
              Power Level (1‚Äì10)
              <div class="power-row">
                <input
                  id="power-level"
                  type="number"
                  min="1"
                  max="10"
                  value="6"
                  step="1"
                />
                <span id="power-level-display" class="power-level-display">
                  6 ‚Äì High
                </span>
              </div>
            </label>

            <label class="checkbox-inline">
              <input type="checkbox" id="tone-epic" checked />
              Make the tone epic and anime-cinematic, but keep mechanics usable at the table.
            </label>
            <label>
              Extra Output Notes
              <textarea
                id="output-notes"
                rows="2"
                placeholder="e.g. one defensive, one offensive, one support; avoid super complex tracking; limit to 5‚Äì7 lines per ability."
              ></textarea>
            </label>
          </div>
        </section>

        <!-- RIGHT: Prompt + Output -->
        <section class="panel panel-output">
          <div class="card">
            <h2>Prompt Preview (auto-built)</h2>
            <p class="hint">
              This is exactly what gets sent to ChatGPT. You can copy it if you want to reuse or
              tweak manually.
            </p>
            <textarea id="prompt-preview" readonly rows="14"></textarea>
          </div>

          <!-- Power level reference -->
          <div class="card">
            <details class="power-ref">
              <summary>Power Level Reference (1‚Äì10)</summary>
              <div class="power-ref-body">
                <p class="hint">
                  How power level influences DC, damage, area, effects, and drawbacks.
                </p>
                <ul class="power-ref-list">
                  <li><strong>1:</strong> DC 4‚Äì6. Very weak / trivial. 0‚Äì1 die or small effect. Mostly utility or soft flavor.</li>
                  <li><strong>2:</strong> DC 6‚Äì7. Very weak but noticeable. 1‚Äì2 dice or a light debuff.</li>
                  <li><strong>3:</strong> DC 7‚Äì9. Weak but useful. 1‚Äì2 dice + minor rider or small control.</li>
                  <li><strong>4:</strong> DC 9‚Äì11. Solid low-tier move. 2‚Äì3 dice, small area or moderate utility.</li>
                  <li><strong>5:</strong> DC 11‚Äì13. Standard PC-level ability. 3‚Äì4 dice, decent effect.</li>
                  <li><strong>6:</strong> DC 13‚Äì16. Strong PC or elite enemy move. 4‚Äì5 dice or strong control.</li>
                  <li><strong>7:</strong> DC 16‚Äì20. Boss-tier. 6‚Äì8 dice, big impact, clear drawback (HP cost, limited uses, etc.).</li>
                  <li><strong>8:</strong> DC 20‚Äì23. Very high. 8‚Äì10+ dice or large area with strong conditions; serious drawback.</li>
                  <li><strong>9:</strong> DC 24‚Äì28. Mythic-level. Can do 100+ total damage, large area, multiple riders and lasting effects; heavy drawback.</li>
                  <li><strong>10:</strong> DC 26‚Äì32. Godlike / reality-warping. Encounter-or arc-defining move with huge damage, massive area, multiple conditions and terrain changes; massive drawback.</li>
                </ul>
              </div>
            </details>
          </div>

          <div class="card">
            <div class="actions">
              <button id="generate-btn">Generate Abilities</button>
              <span id="status-text"></span>
            </div>
          </div>

          <div class="card">
            <h2>Generated Abilities üé¥</h2>

            <!-- View / export controls -->
            <div class="results-toolbar">
              <div class="view-toggle">
                <button id="view-cards-btn" class="chip active">Cards</button>
                <button id="view-table-btn" class="chip">Table</button>
              </div>
              <div class="results-actions">
                <button id="copy-all-btn" class="chip small">Copy All</button>
                <button id="download-txt-btn" class="chip small">Download Stat Sheet</button>
                <button id="print-btn" class="chip small">Print / PDF</button>
              </div>
            </div>

            <!-- Saved sets (databank) -->
            <div class="saved-toolbar">
              <button id="save-set-btn" class="chip small">Save Set</button>
              <select id="load-set-select">
                <option value="">Load saved set‚Ä¶</option>
              </select>
              <button id="delete-set-btn" class="chip small subtle">
                Delete
              </button>
            </div>

            <div id="results" class="results-box">
              <p class="hint">
                Each generated ability will show up in its own card with: name, summary, cinematic
                description, and key mechanics (range, DC, damage, effect). Switch between card and
                table view above.
              </p>
            </div>
          </div>
        </section>
      </main>

      <footer class="app-footer">
        <small>
          All on one page. Built for quick use at the table: check boxes, add flavor, press
          Generate.
        </small>
      </footer>
    </div>

    <script src="script.js"></script>
  </body>
</html>
